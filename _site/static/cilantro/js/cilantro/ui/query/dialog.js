define(["underscore","marionette"],function(t,e){var i=e.ItemView.extend({className:"modal hide",template:"query/delete-dialog",options:{header:"Delete Query"},events:{"click .delete-query-button":"deleteQuery"},ui:{header:".modal-header h4",alert:".alert"},showError:function(t){this.ui.alert.html(t).show()},hideError:function(){this.ui.alert.hide()},deleteQuery:function(){this.hideError();var t=this.model,e=this;this.model.destroy().fail(function(){e.open(t),e.showError("Sorry, there was a problem deleting your query. Please try again.")}),this.close()},onRender:function(){this.ui.header.text(this.options.header),this.$el.modal({show:!1,keyboard:!1,backdrop:"static"})},open:function(t){this.hideError(),this.model=t,this.$el.modal("show")},close:function(){delete this.model,this.$el.modal("hide")}}),n=e.ItemView.extend({className:"modal hide",template:"query/edit-dialog",options:{header:"Query Properties"},events:{"click [data-save]":"saveQuery"},ui:{header:".modal-header h4",alert:".alert",name:".query-name",description:".query-description",email:".query-emails",publicity:".query-publicity"},initialize:function(){if(this.data={},!(this.data.context=this.options.context))throw new Error("context model required");if(!(this.data.view=this.options.view))throw new Error("view model required")},showError:function(t){this.ui.alert.html(t).show()},hideError:function(){this.ui.alert.hide()},saveQuery:function(){if(this.hideError(),!this.ui.name.val())return this.showError("Please supply a name for the query"),void 0;var t={name:this.ui.name.val(),description:this.ui.description.val(),usernames_or_emails:this.ui.email.val(),"public":this.ui.publicity.prop("checked")};this.model||(this.model=new this.collection.model,t.context_json=this.data.context.toJSON().json,t.view_json=this.data.view.toJSON().json),this.model.collection||this.collection.add(this.model);var e=this.model,i=this;this.model.save(t).fail(function(){i.open(e),i.showError("Sorry, there was a problem saving your query. Please try again.")}),this.close()},onRender:function(){this.ui.header.text(this.options.header),this.$el.modal({show:!1,keyboard:!1,backdrop:"static"})},open:function(e){this.hideError(),this.model=e;var i,n,o,s;if(e)i=this.model.get("name"),n=this.model.get("description"),o=t.pluck(this.model.get("shared_users"),"email").join(", "),s=this.model.get("public");else{var r=Date().toString().split(" ");i="Query on "+r.slice(0,5).join(" "),n="",o="",s=!1}this.ui.name.val(i),this.ui.description.val(n),this.ui.email.val(o),this.ui.publicity.prop("checked",s),this.$el.modal("show")},close:function(){delete this.model,this.$el.modal("hide")}});return{DeleteQueryDialog:i,EditQueryDialog:n}});
//@ sourceMappingURL=dialog.js.map