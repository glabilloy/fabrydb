define(["underscore","marionette","../base","../core"],function(t,e,i,n){var o=i.LoadView.extend({align:"left"}),s=e.ItemView.extend({className:"row-fluid",template:"query/item",options:{editable:!1},ui:{owner:".owner",nonOwner:".non-owner",shareCount:".share-count",publicIcon:".public-icon"},events:{"click [data-toggle=delete-query-modal]":"showDeleteQueryModal","click [data-toggle=edit-query-modal]":"showEditQueryModal","click .shared-query-name":"openQuery"},modelEvents:{sync:"render"},initialize:function(){if(this.data={},!(this.data.context=this.options.context))throw new Error("context model required");if(!(this.data.view=this.options.view))throw new Error("view model required")},serializeData:function(){var t=this.model.toJSON();return t.shared_users||(t.shared_users=[]),t.user||(t.user={}),t},openQuery:function(){this.data.view.save("json",this.model.get("view_json")),this.data.context.save("json",this.model.get("context_json"),{reset:!0}),n.router.navigate("results",{trigger:!0})},showEditQueryModal:function(){this.trigger("showEditQueryModal",this.model)},showDeleteQueryModal:function(){this.trigger("showDeleteQueryModal",this.model)},onRender:function(){if(this.options.editable&&this.model.get("public")&&this.ui.publicIcon.removeClass("hidden"),this.model.get("is_owner")){this.ui.nonOwner.hide();var e=t.pluck(this.model.get("shared_users"),"email");this.ui.shareCount.attr("title",e.join("<br>")),this.ui.shareCount.tooltip({html:!0,animation:!1,placement:"right",container:"body"})}else this.ui.owner.hide();this.options.editable||(this.ui.nonOwner.hide(),this.ui.owner.hide())}});return{LoadingQueryItem:o,QueryItem:s}});
//@ sourceMappingURL=item.js.map